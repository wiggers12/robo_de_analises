<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rob√¥ de An√°lises - Aviator</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #000;
      overflow: hidden;
      font-family: Arial, sans-serif;
      color: white;
    }

    iframe {
      width: 100%;
      height: 100vh;
      border: none;
    }

    /* Bot√£o flutuante */
    #botaoFlutuante {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background-color: #00bcd4;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 15px 20px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
      z-index: 9999;
    }

    #botaoFlutuante:hover {
      background-color: #0097a7;
      transform: scale(1.05);
    }

    /* Painel lateral */
    #painel {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100%;
      background-color: #1a1a1a;
      box-shadow: -4px 0 10px rgba(0,0,0,0.5);
      transition: right 0.4s ease-in-out;
      padding: 20px;
      overflow-y: auto;
      z-index: 10000;
    }

    #painel.aberto {
      right: 0;
    }

    #painel h2 {
      text-align: center;
      color: #00bcd4;
      margin-bottom: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      border-bottom: 1px solid #333;
      padding: 8px;
      text-align: center;
    }

    tr:nth-child(even) {
      background: #222;
    }

    #media {
      margin-top: 10px;
      text-align: center;
      font-size: 18px;
      color: #00e676;
    }

    /* Fechar painel */
    #fecharPainel {
      background: #ff1744;
      border: none;
      color: white;
      padding: 8px 12px;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 10px;
    }
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js"></script>
</head>

<body>

  <!-- JOGO AO VIVO -->
  <iframe src="https://big.bet.br/casino/game/3496406?provider=Spribe&from=%2Fcasino"></iframe>

  <!-- BOT√ÉO FLUTUANTE -->
  <button id="botaoFlutuante">üìä Aguardando leitura...</button>

  <!-- PAINEL LATERAL -->
  <div id="painel">
    <button id="fecharPainel">Fechar ‚úñ</button>
    <h2>√öltimos Resultados</h2>
    <table id="tabela">
      <tr><th>#</th><th>Valor</th><th>Hora</th></tr>
    </table>
    <p id="media">M√©dia: --</p>
  </div>

  <script>
    // üî• Configura√ß√£o do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyD-yt8AmgRkMnJH9xKwDSKn9_X42Cmpq7Y",
      authDomain: "robo-aviator2025.firebaseapp.com",
      projectId: "robo-aviator2025",
      storageBucket: "robo-aviator2025.firebasestorage.app",
      messagingSenderId: "303072216239",
      appId: "1:303072216239:web:d6e659c5dd49be14e7005a",
      measurementId: "G-094LT3104Y"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const botao = document.getElementById('botaoFlutuante');
    const painel = document.getElementById('painel');
    const fechar = document.getElementById('fecharPainel');
    const tabela = document.getElementById('tabela');
    const mediaEl = document.getElementById('media');

    // üîÅ Atualiza painel
    async function atualizarPainel() {
      const snapshot = await db.collection("resultados").orderBy("hora", "desc").limit(15).get();
      tabela.innerHTML = "<tr><th>#</th><th>Valor</th><th>Hora</th></tr>";

      let soma = 0;
      let cont = 0;

      snapshot.forEach((doc, i) => {
        const data = doc.data();
        const valor = parseFloat(data.valor);
        const hora = data.hora || "--";
        soma += valor;
        cont++;

        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${i + 1}</td><td>${valor.toFixed(2)}x</td><td>${hora}</td>`;
        tabela.appendChild(tr);
      });

      if (cont > 0) {
        const media = (soma / cont).toFixed(2);
        mediaEl.innerText = `üìà M√©dia das √∫ltimas: ${media}x`;
      } else {
        mediaEl.innerText = "Sem dados recentes.";
      }
    }

    // üì° Atualiza bot√£o em tempo real
    db.collection("resultados").orderBy("hora", "desc").limit(1)
      .onSnapshot(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();
          const valor = parseFloat(data.valor);
          botao.innerText = `üìà √öltima leitura: ${valor.toFixed(2)}x`;
          botao.style.background = valor >= 2 ? "#4CAF50" : "#F44336";
        });
      });

    // üß≠ A√ß√µes do painel
    botao.onclick = () => {
      painel.classList.toggle("aberto");
      atualizarPainel();
    };
    fechar.onclick = () => painel.classList.remove("aberto");

    // Atualiza a cada 5 segundos
    setInterval(atualizarPainel, 5000);
  </script>

</body>
</html>
